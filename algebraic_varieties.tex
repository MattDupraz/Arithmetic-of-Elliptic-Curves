\section{Algebraic Varieties}

\comment{Motivate the definitions,
remind important definitions from the course}

\begin{definition}
	Let $V$ be a algebraic variety. Let $L$ be a subfield of $K$.
	We say that $V$ is \emph{defined over} $L$ when the ideal of
	$V$ can be generated by polynomials in $L[X]$.
	We will denote this by $V/L$.
\end{definition}

\begin{definition}
	Let $L \subseteq K$ a subfield.
	We define the set $\A^n(L) \subseteq \A^n$ as
	\begin{equation*}
		\A^n(L) := \{(x_1, \dots, x_n) \in \A^n \mid x_i \in L\}.
	\end{equation*}
	We call this set the \emph{set of $L$-rational} points of $\A^n$.
	Similarly, we define
	\begin{equation*}
		\proj^n(L) := \{[x_1, \dots, x_{n+1}) \in \proj^n \mid x_i \in L\},
	\end{equation*}
	the set of $L$-rational points of $\proj^n$.
\end{definition}

\begin{definition}
	Let $L \subset K$ a subfield.
	Let $V/L$ be an algebraic variety defined over $L$.
 	We define the set
	of $L$-rational points of $V$
	\begin{equation*}
		V(L) := 
		\begin{cases}
			V\cap\A^n(L) &\textrm{if $V$ is affine;}\\
			V\cap\proj^n(L) &\textrm{if $V$ is projective.}
		\end{cases}
	\end{equation*}
\end{definition}

The projective space $\proj^n$ can be covered by copies of $\A^n$. Define
\begin{equation*}
	U_i := \{[x_0, \dots, x_n] \in \proj^n \mid x_i \neq 0\},
\end{equation*}
then $U_i$ is isomorphic to $\A^n$ via the chart
\begin{equation*}
	\phi_i: U_i \to \A^n, [x_0, \dots, x_n] \mapsto \left(\frac{x_1}{x_i}, \dots,
		\frac{x_{i-1}}{x_i}, \frac{x_{i+1}}{x_i}, \dots, 
		\frac{x_n}{x_i}\right)
\end{equation*}

\begin{notation}
	Thanks to the above isomorphism, we can see $\A^n$ as a chosen
	$U_i \subset \proj^n$. Hence we can see any affine variety
	$V \subseteq \A^n$ as a subset of $\proj^n$. Similarly, if $V \subseteq
	\proj^n$ is a projective variety,
	then for a chosen $\A^n \subseteq \proj^n$,
	$V \cap \A^n$ is an affine variety.
\end{notation}
\comment{Not sure I want to keep this notation}

\begin{definition}
	For $V \subseteq \proj^n$ a subset, we define $\cl{V}$ the (Zariski)
	\emph{closure}, the closure of $V$ in the Zariski topology of $\proj^n$.
\end{definition}

\begin{proposition}
	\begin{enumerate}
		\item For $V$ an affine variety, $\cl{V}$ is a projective variety, and
		\begin{equation*}
			V = \cl{V} \cap \A^n.
		\end{equation*}
		\item Let $V$ be a projective variety. Then $V \cap \A^n$ is an affine
			variety, and either
			\begin{equation*}
				V \cap \A^n = \emptyset
				\textrm{ or }
				V = \cl{V \cap \A^n}
			\end{equation*}
	\end{enumerate}
\end{proposition}

\begin{proof}
	\begin{enumerate}
		\item Follows from Lemma 3.5 from the course "Algebraic curves".
		\item Suppose $V \cap \A^n \neq \emptyset$. We have that
			$V \supseteq V \cap \A^n$ and $V$ is closed, hence
			$V \supseteq \cl{V \cap \A^n}$.
			$V \setminus \A^n$ is closed, and
			\begin{equation*}
				V = \cl{V \cap \A^n} \cup (V \setminus \A^n).
			\end{equation*}
			By irreducibility of $V$ and the fact $V \cap \A^n \neq \emptyset$
			and so $V \neq (V \setminus \A^n)$, we get $V = \cl{V \cap \A^n}$.
	\end{enumerate}
\end{proof}

\begin{definition}
	Let $V \subseteq \A^n$ be an affine variety, $P \in V$ and 
	$f_1, \dots, f_m \in K[X_1, \dots, X_n]$ a set of generators of $I(V)$.
	Then $V$ is \emph{non-singular}, or \emph{smooth} at $P$ if the Jacobian
	of $(f_1, \dots, f_m)$ at $P$ has rank $n - \dim(V)$.
	If $V$ is non-singular at every point, then $V$ is \emph{non-singular},
	or \emph{smooth}.
\end{definition}

\begin{definition}
	Let $V \subseteq \proj^n$ be a projective variety,
	$P \in V$ and choose $\A^n \subseteq \proj^n$ such
	that $P \in \A^n$. Then $V$ is \emph{non-singular}, or \emph{smooth}
	at $P$ if $V \cap \A^n$ is smooth at $P$ (as an affine variety).
\end{definition}

\begin{proposition}
	\label{prop:function-fields}
	Let $V \subseteq \proj^n$ be a projective variety,
	for any $\A^n \subseteq \proj^n$, $K(V) = K(V\cap \A^n)$.
\end{proposition}

\begin{proof}
	Follows from Proposition 3.11 from the course "Algebraic curves".
\end{proof}

\begin{definition}
	Let $V_1 \subseteq \proj^n, V_2 \subseteq \proj^m$ be projective varieties.
	A \emph{rational map} from $V_1$ to $V_2$ is a map of the form
	\begin{align*}
		\phi: V_1 &\to V_2\\
		P &\mapsto [f_0(P), \dots, f_m(P)],
	\end{align*}
	where $f_0, \dots, f_m \in K(V_1)$ are such that
	for all $P \in V_1$ at which $f_0, \dots, f_n$ are all defined, 
	$\phi(P) \in V_2$.
\end{definition}

\begin{definition}
	A rational map $\phi = [f_0, \dots, f_m]: V_1 \to V_2$
	is \emph{regular} at $P \in V_1$ if there is a function $g \in K(V_1)$,
	such that
	\begin{enumerate}[label=(\roman*)]
		\item each $gf_i$ is regular at $P$
		\item for some $i$, $(gf_i)(P) \neq 0$
	\end{enumerate}
	If such a $g$ exists, we set
	\begin{equation*}
		\phi(P) = [(gf_0)(P), \dots, (gf_m)(P)]
	\end{equation*}
\end{definition}

\begin{proposition}
	Let $\phi = [f_1, \dots, f_m]: V_1 \to V_2$ be a rational map. Then
	$\phi$ is regular at all $P \in V_1$ if and only if
	$\phi$ is a morphism.
\end{proposition}
\comment{Remind definition of morphism?}

\begin{proof}
	Suppose first that $\phi$ is a morphism, let $P \in V_1$.
	Choose $i$ such that $\phi(P) \in U_i \subseteq V_2$, 
	where $U_i = \{[x_0, \dots, x_m] \in \proj^m \mid x_i \neq 0\}$.
	For each $j$, define the map
	\begin{align*}
		h_j: V_2\cap U_i &\to K\\
		[x_0, \dots, x_m] &\mapsto \frac{x_j}{x_i}
	\end{align*}
	By definition, $h_j \in \O(V_2\cap U_i)$.
	Since $\phi$ is a morphism, we get that
	$h_j \circ \phi = \frac{f_j}{f_i}: \phi^{-1}(V_2\cap U_i) \to K$ is regular.
	%In particular, since $f_i(u) \neq 0$ for all $u \in \phi^{-1}(V_2\cap U_i)$,
	%we get that
	%$1/f_i \in \O(\phi^{-1}(V_2\cap U_i))$.
	Setting $g = 1/f_i \in K(V_1)$, we get that
	$gf_j$ is regular at $P$ for all $j$ and $gf_i = 1 \neq 0$.
	Hence $\phi$ is regular at $P$.

	For the other implication, suppose $\phi$ is regular at all $P \in V_1$.
	Let $W \subseteq V_2$ open and $f \in \O(W)$, we have to show that
	$f\circ\phi: \phi^{-1}(W) \to K$ is regular.
	Let $P \in \phi^{-1}(W)$, then since $\phi$ is regular at $P$,
	there exists $g \in K(V_1)$ such that each $gf_i$ is regular at $P$
	and for some $i$, $(gf_i)(P) \neq 0$.
	Since $f$ is regular at $\phi(P)$, there exist polynomials
	$p, q \in K[x_0, \dots, x_n]$ homogeneous of the same degree
	with $q(\phi(P)) \neq 0$ and 
	$f(Q) = \frac{p(Q)}{q(Q)}$ for all $Q \in W\setminus q^{-1}(0)$. Then
	\begin{equation*}
		f \circ \phi = \frac{p(f_0, \dots, f_m)}{q(f_0, \dots f_m)}
		= \frac{p(gf_0, \dots, gf_m)}{q(gf_0, \dots, gf_m)}
	\end{equation*}
	We have that both $p(gf_0, \dots, gf_m)$ and $q(gf_0, \dots, gf_m)$ are
	regular. Furthermore, $q(gf_0, \dots, gf_m)(P) = q(\phi(P)) \neq 0$
	and hence we deduce that $f\circ \phi$ is regular.
	This implies that $\phi$ is a morphism.
\end{proof}
