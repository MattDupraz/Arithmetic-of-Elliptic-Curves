\section{Elliptic Curves}

\subsection{Definition and basic properties}

We now have all the prerequisites to define what an elliptic curve is.
\begin{definition}
	An \emph{elliptic curve} is a smooth curve $E$ of genus 1 with a specified point
	$O \in E$.
\end{definition}
We will see later that $E$ can be given the structure of a group, which is the
reason why we
specify a point $O$, which will act as the identity element.

A \emph{Weierstrass equation} is an equation of a 
projective curve $C \subset \proj^2$ of the form
\begin{equation*}
	Y^2Z + aXYZ + bYZ^2 = X^3 + cX^2Z + dXZ^2 + eZ^3.
\end{equation*}
We can consider the set $U_Z = \{Z \neq 0\} \subset \proj^2$. We have that
$C \cap U_Z$ is an affine curve for which the set of points
$[X, Y, 1] \in C\cap U_Z$ is specified by the dehomogenized equation
\begin{equation*}
	Y^2 + aXY + bY = X^3 + cX^2 + dX + e.
\end{equation*}
To ease notation, we will 
use the dehomogenized equation to define the projective curve $C$,
remembering that there is the point at infinity $[0, 1, 0]$.

The following proposition allows us to identify elliptic curves
with smooth curves given by a Weierstrass equation.
\begin{proposition}
	\label{prop:curve-correspondence}
	Let $(E, O)$ be an elliptic curve defined over $K$.
	\begin{enumerate}[itemsep=0em, label=(\alph*)]
		\item There exist functions $x, y \in K(E)$ such that the map
			\begin{align*}
				\phi: E &\to \proj^2\\
				P &\mapsto [x(P), y(P), 1]
			\end{align*}
			gives an isomorphism of $E$  onto a curve given by the Weierstrass equation
			\begin{equation*}
				C: Y^2 + aXY + bY = X^3 + cX^2 + dX + e
			\end{equation*}
			with coefficients $a, b, c, d, e \in K$ and such that $\phi(O) =
			[0,1, 0]$.
		\item Any two equations for $E$ as in (a) are related by a linear change
			of variables of the form
			\begin{align*}
				X &= u^2X' + r\\
				Y &= u^3Y' + su^2X' + t
			\end{align*}
			with $u, r, s, t \in K, u \neq 0$.
		\item Conversely any smooth curve $C$ given by a Weierstrass equation as in (a)
			is an elliptic curve with origin $O = [0, 1, 0]$.
	\end{enumerate}
\end{proposition}

Now let $E$ be an elliptic curve defined by the Weierstrass equation
\begin{equation}
	\label{weierstrass-eq}
	E: Y^2 + aXY + bY = X^3 + cX^2 + dX + e
\end{equation}
for some $a, b, c, d, e \in K$ with origin $O = [0, 1, 0]$.

When $\chr(K) \not\in \{2, 3\}$ (recall we assumed this is true throughout this
paper), we can simplify (\ref{weierstrass-eq}) using changes of variables,
if we set $Y = Y' - \frac{1}{2}(aX'  + b)$ we obtain an equation of the form
\begin{equation*}
	Y'^2 = X^3 + c'X^2 + d'X + e'
\end{equation*}
with $c', d', e' \in K$. We can also get rid of the term $X^2$ with the
substitution $X = X' - \frac{1}{3}c'$, we obtain an equation of the form
\begin{equation*}
	Y'^2 = X'^3 + AX' + B
\end{equation*}
with $A, B \in K$. A quick calculation yields $c' = c + \frac{1}{4}a^2$,
hence up to using the linear change of variables
\begin{align*}
	X &= X' - \frac{1}{3}\left(c  + \frac{1}{4}a^2\right),\\
	Y &= Y' - \frac{1}{2}(aX'  + b),
\end{align*}
we can always suppose an elliptic curve $E$ is given by the equation
\begin{equation*}
	E: Y^2 = X^3 + AX + B.
\end{equation*}

From \ref{prop:correspondence}, we know that a curve given by the an equation
of the above form is an elliptic curve whenever it is smooth.
The following proposition answers the question of when that is the case.
\begin{proposition}
	\label{prop:singular-determinant}
	Let $C$ be a projective plane curve defined by
	\begin{equation*}
		C: F(X, Y) = X^3 + AX + B - Y^2 = 0.
	\end{equation*}
	Let $\Delta = 4A^3 + 27B^2$ be the discriminant of $F(X, 0)$, then 
	$C$ is smooth (and hence an elliptic curve)
	if and only if $\Delta \neq 0$.
\end{proposition}
\begin{proof}
	First, let us verify that $O = [0, 1, 0]$ is not singular.
	If we look at $C$ in the chart $U_Y = \{Y \neq 0\}$, we get
	that $C$ is given by the equation
	\begin{equation*}
		G(X, Z) = X^3 + AXZ^2 + BZ^3 - Z = 0.
	\end{equation*}
	We have that
	\begin{equation*}
		\nabla G(0, 0) =
		\begin{bmatrix}
			0\\
			1
		\end{bmatrix} \neq 0,
	\end{equation*}
	and so $O$ is a smooth point of $C$.
	

	Suppose there is a point $P = (x, y) \in C$ that is singular,
	then we have
	\begin{equation*}
		\nabla F(P) =
		\begin{bmatrix}
			3x^2 + A\\
			-2y\\
		\end{bmatrix} = 0
	\end{equation*}
	Hence we have that $\frac{\partial}{\partial X}F(x, 0) 
	= 3x^2 + A = 0$.
	In particular, since $P \in C$, also 
	$F(x, 0) = 0$, and hence
	$x$ is a double root of $F(X, 0)$ so we deduce that the discriminant
	$\Delta = 4A^3 + 27B^2$ is zero.

	Suppose instead that $\Delta = 0$, then $F(X, 0)$ admits a double root
	$x \in K$ (recall $K$ is algebraically closed).
	Then $P = (x, 0) \in C$ and
	\begin{equation*}
		\nabla F(P) =
		\begin{bmatrix}
			3x^2 + A\\
			0\\
		\end{bmatrix} = 0,
	\end{equation*}
	since $3x^2 + A = \frac{\partial}{\partial X}F(x, 0) = 0$.
	It follows that $C$ is singular at $P$.
\end{proof}

\subsection{Group Law}

Let $E$ be an elliptic curve. For any line $L \subset \proj^2$, $L$ intersects
$E$ in exactly 3 points (taken with multiplicity). This allows us
to define a composition law $+$ on $E$ as
follows.

\begin{definition}
	\label{def:group-law}
	Let $P, Q \in E$ and $L$ the line connecting $P$ and $Q$ (or the tangent line
	to $E$ at $P$ if $P = Q$). Let $R$ be the third point of intersection of $L$
	with $E$. Let $L'$ be the line connecting $R$ and $O$. We define $P + Q$
	be the third point of intersection of $L'$ with $E$.
\end{definition}

% Proposition: properties, it makes E an abelian group with identity O

\begin{notation}
	For $m \in \N\setminus\{0\}$ and $P \in E$ we define
	\begin{equation*}
		[m]P = \underbrace{P + \dots + P}_{m\textrm{ times}}.
	\end{equation*}
	We extend this definition to $m \in \Z$ with $[0]P = O$ and
	$[m]P = [-m](-P)$ for $m < 0$.
\end{notation}

As we have seen, any elliptic curve can be written up to isomorphism
under the form
\begin{equation*}
	E: y^2 = x^3 + ax + b
\end{equation*}
Since this isomorphism is induced by linear changes of variables, it
sends lines to lines and hence this preserves the group structure on
$E$ induced by $+$. Hence in what follows, we consider simply elliptic curves of
the above form.
Let $F(x, y) = y^2 - x^3 - ax - b$, so that $E$ is given by the equation
$F(x, y) = 0$.

Let $P = (x_P, y_P) \in E$, then we
\begin{equation*}
	-P = (x_P, -y_P),
\end{equation*}
which is clear by inspection of the composition law.

Now let $Q = (x_Q, y_Q) \in E$ different from $-P$. Then $P + Q \neq O$.
Suppose $P \neq Q$, then $x_P \neq x_Q$. 
We have that the line passing through $P$ and $Q$ is given by
\begin{equation*}
	L: y = \frac{y_Q - y_P}{x_Q - x_P}(x - x_P) + y_P
\end{equation*}
Setting 
\begin{equation*}
	\lambda = \frac{y_Q - y_P}{x_Q - x_P}
	\quad\textrm{ and }\quad
	\nu = \frac{x_Qy_P - x_Py_Q}{x_Q - x_P}
\end{equation*}
we can rewrite $L: y = \lambda x - \nu$.

If $P = Q$, then $L$ is the tangent to $E$ at $P$, which is given by
\begin{equation*}
	L: (3x_P^2 + a)(x - x_P) - 2y_P(y - y_P) = 0
\end{equation*}
If $y_P = 0$, $L$ is the line $x = x_P$ and so the third point of intersection
is $O$, whence $P + Q = O$, which contradicts our assumption, and so 
$y_P \neq 0$.
To obtain again an equation of the form $L = \lambda x - \nu$, we have to set
\begin{equation*}
	\lambda = \frac{3x_P^2 + a}{2y_P}
	\quad\textrm{ and }\quad
	\nu = \frac{-3x_P^3 - ax_P + 2y_P^2}{2y_P} = \frac{-x_P^3 + ax_P + 2b}{2y_P}.
\end{equation*}

So let $\lambda$ and $\nu$ be as above corresponding to the case.
Let $R$ be the third point of intersection of $L$ with $E$.
We have that the equation $F(x, \lambda x + \nu) = 0$ with respect to $x$
admits exactly the zeroes $x_P, x_Q, x_R$ and hence
\begin{equation*}
	F(x, \lambda x + \nu) = c(x - x_P)(x - x_Q)(x - x_R)
\end{equation*}
Since the coefficient of $x^3$ in $F(x, \lambda x + \nu)$ is $-1$, we obtain
$c = -1$. By equating the coefficient of $x^2$, we obtain
$\lambda^2 = x_P + x_Q + x_R$ and hence
\begin{align*}
	x_R &= \lambda^2 - x_P - x_Q\\
	y_R &= \lambda x_R + \nu
\end{align*}
Finally, we obtain $P + Q = (x_R, -y_R)$.

This can be summarized in the following proposition:
\begin{proposition}
	Let $E$ be an elliptic curve given by the Weierstrass equation
	\begin{equation*}
		E: y^2 = x^3 + ax + b.
	\end{equation*}
	Let $P = (x_P, y_P), Q = (x_Q, y_Q) \in E$ be two points with $P \neq \pm Q$.
	Then 
	\begin{enumerate}
		\item The addition formula:
			\begin{align*}
				x_{P + Q} &= \left( \frac{y_Q - y_P}{x_Q - x_P} \right)^2
				- x_P - x_Q\\
				y_{P + Q} &= -\frac{y_Q - y_P}{x_Q - x_P}x_{P+Q} + \frac{x_Qy_P -
				x_Py_Q}{x_Q - x_P}
			\end{align*}
		\item The duplication formula. Write $P = (x, y)$, then
			\begin{align*}
				x_{[2]P} &= \left( \frac{3x^2 + a}{2y} \right)^2
				- 2x\\
				&= \frac{x^4 - 2ax^2 - 8bx + a^2}{4(x^3 + ax + b)}\\
				y_{[2]P} &= - \frac{3x^2 + a}{2y}x_{[2]P}
				+ \frac{-x^3 + ax + 2b}{2y}
			\end{align*}
	\end{enumerate}
\end{proposition}


\begin{lemma}
	\label{lem:sim-implies-eq}
	Let $C$ be a curve of genus 1, and let $P, Q \in C$. Then
	\begin{equation*}
		(P) \sim (Q)
		\quad\textrm{if and only if}\quad
		P = Q
	\end{equation*}
\end{lemma}

\begin{proof}
	Suppose $(P) \sim (Q)$, then there exists some $f \in K(C)$ such that
	\begin{equation*}
		\div(f) = (P) - (Q).
	\end{equation*}
	We have that $f \in \L((Q))$ and by Riemann-Roch (\ref{thm:riemann-roch}),
	it follows that
	\begin{equation*}
		\dim \L((Q)) = \deg((Q)) - g + 1 = 1.
	\end{equation*}
	Since $\L((Q))$ already contains the constant functions, $f \in \L((Q)) = K$
	and so $P = Q$.
\end{proof}

\begin{proposition}
	Let $E$ be an elliptic curve. Then $E$ equipped with the group law from 
	\ref{def:group-law}
	and $\Cl^0(E)$ are isomorphic. The isomorphism is given by the map
	\begin{align*}
		\kappa: E &\to \Cl^0(E)\\
		P &\mapsto [(P) - (O)]
	\end{align*}
\end{proposition}

\begin{proof}
	Let $D \in Div^0(E)$ be a divisor. Since $E$ has genus 1, 
	by the Riemann-Roch theorem (\ref{thm:riemann-roch}), we have that
	\begin{equation*}
		\dim\L(D + (O)) = 1.
	\end{equation*}
	Let $f \in K(E)$ be a generator for $\L(D + (O))$. Since
	\begin{equation*}
		\div(f) \geq -D -(O)
		\quad\textrm{ and }\quad
		\deg(\div(f)) = 0,
	\end{equation*}
	we have necessarily that 
	\begin{equation*}
		\div(f) = -D -(O) + (P)
	\end{equation*}
	for some $P \in E$.
	Hence 
	\begin{equation*}
		D \sim (P) - (O).
	\end{equation*}
	Suppose there is some other $P' \in E$, such that $D \sim (P') - (O)$.
	Then $(P) \sim (P')$, but then $P = P'$ from \ref{lem:sim-implies-eq}.
	
	This allows us to define
	\begin{equation*}
		\sigma: \Div^0(E) \to E,
	\end{equation*}
	which sends a divisor $D \in \Div^0(E)$ to the corresponding point $P \in E$
	as above.

	This map is clearly surjective, as $\sigma((P) - (O)) = P$. Furthermore, we
	have that $\sigma(D_1) = \sigma(D_2)$ if and only if $D_1 \sim D_2$.
	Indeed, if $D_1 \sim D_2$, then 
	\begin{equation*}
		(\sigma(D_1)) - (O) \sim (\sigma(D_2)) - (O)
	\end{equation*}	
	and hence $\sigma(D_1) = \sigma(D_2)$ by \ref{lem:sim-implies-eq}.
	Conversely, if $\sigma(D_1) = \sigma(D_2)$, then clearly
	\begin{equation*}
		D_1 \sim (\sigma(D_1)) - (O) = (\sigma(D_2)) - (O) \sim D_2.
	\end{equation*}
	We deduce that $\sigma$ induces a bijection $\cl{\sigma}: \Cl^0(E) \to E$.
	Furthermore, clearly $\overline{\sigma} = \kappa^{-1}$.

	It remains to show that $\kappa$ is a group homomorphism.
	Clearly, $\kappa(O) = 0$, so we have to show that for $P, Q \in E$,
	$\kappa(P + Q) = \kappa(P) + \kappa(Q)$.

	Let
	\begin{equation*}
		f(X, Y, Z) = \alpha X + \beta Y + \gamma Z = 0
	\end{equation*}
	give the line $L$ in $\proj^2$ going through $P, Q$ and let $R$ be the third
	point of intersection.
	We then have that $f/Z \in K(E)$ and since $Z$ intersects $E$ at $O$ with
	multiplicity 3, we have
	\begin{equation*}
		\div(f/Z) = \sum_{P \in E}\ord_P(f)(P) - \ord_P(Z)(P)
		= (P) + (Q) + (R) - 3(O).
	\end{equation*}
	Now let 
	\begin{equation*}
		f'(X, Y, Z) = \alpha' X + \beta' Y + \gamma' Z = 0
	\end{equation*}
	be the line $L'$ through $R$ and $O$. Then by the definition of addition on
	$E$, we have that the third point of intersection of $L'$ with $E$ is 
	$P + Q$. As above, $f'/Z \in K(E)$ and we have
	\begin{equation*}
		\div(f'/Z) = (R) + (O) + (P + Q) - 3(O) = (R) + (P + Q) - 2(O).
	\end{equation*}
	It follows that
	\begin{equation*}
		\div(f'/f) = \div(f'/Z) - \div(f/Z) = (P + Q) - (P) - (Q) + (O)
	\end{equation*}
	And hence
	\begin{align*}
		\kappa(P + Q) - \kappa(P) - \kappa(Q) &= 
		[(P + Q) - (O)] - [(P) - (O)] - [(Q) - (O)]\\
		&= [(P + Q) - (P) - (Q) + (O)] = 0.
	\end{align*}
\end{proof}

\begin{corollary}
	Let $E$ be an elliptic curve and $D = \sum n_P(P) \in \Div(E)$. Then $D$
	is principal if and only if $\sum n_P = 0$ and $\sum [n_P]P = O$
\end{corollary}

\begin{proof}
	Suppose $D$ is principal, so $D\sim 0$. 
	Principal divisors have degree $0$,
	hence $\sum n_P = 0$. It follows that
	\begin{align*}
		\kappa\left(\sum [n_P]P\right) &= \sum n_P\kappa(P) = \sum n_P [(P) -
		(O)]\\
		&= \left[\sum n_P (P)\right] = 0
	\end{align*}
	And hence $\sum [n_P]P = 0$ by injectivity of $\kappa$.

	Now suppose $\sum n_P = 0$ and $\sum [n_P] P = O$,
	then by the above calculation,
	\begin{equation*}
		[D] = \left[\sum n_P(P)\right] = \kappa\left(\sum [n_P] P\right) = 0
	\end{equation*}
	and so $D \sim 0$.
\end{proof}

\subsection{Isogenies}

\begin{definition}
	Let $E_1$ and $E_2$ be elliptic curves. An \emph{isogeny} between
	$E_1$ and $E_2$ is a morphism
	\begin{equation*}
		\phi: E_1 \to E_2
	\end{equation*}
	satisfying $\phi(O) = O$. $E_1$ and $E_2$ are \emph{isogenous} if
	there exists a non-constant isogeny $\phi$ between them.
\end{definition}

\begin{definition}
	Let $E$ be an elliptic curve and $m \in \Z$, $m \neq 0$. The
	$m$-\emph{torsion subgroup} of $E$, denoted $E[m]$, is the set of
	points of order $m$ in $E$.
	\begin{equation*}
		E[m] = \{P \in E \mid [m]P = O\}.
	\end{equation*}
	The \emph{torsion subgroup} of $E$, denoted $E_\tors$, is the set of
	points of finite order in $E$.
	\begin{equation*}
		E_\tors = \bigcup_{m=1}^\infty E[m]
	\end{equation*}
\end{definition}

\subsection{The Dual Isogeny}

\subsection{The Tate Module}

\subsection{The Weil Pairing}
