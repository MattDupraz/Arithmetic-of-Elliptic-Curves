\section{Elliptic Curves}

\subsection{Definition and basic properties}

We now have all the prerequisites to define what an elliptic curve is.
\begin{definition}
	An \emph{elliptic curve} is a smooth curve $E$ of genus 1 with a specified point
	$O \in E$.
\end{definition}
We will see later that $E$ can be given the structure of a group, which is the
reason why we
specify a point $O$, which will act as the identity element.

A \emph{Weierstrass equation} is an equation of a 
projective curve $C \subset \proj^2$ of the form
\begin{equation*}
	Y^2Z + aXYZ + bYZ^2 = X^3 + cX^2Z + dXZ^2 + eZ^3.
\end{equation*}
We can consider the set $U_Z = \{Z \neq 0\} \subset \proj^2$. We have that
$C \cap U_Z$ is an affine curve for which the set of points
$[X, Y, 1] \in C\cap U_Z$ is specified by the dehomogenized equation
\begin{equation*}
	Y^2 + aXY + bY = X^3 + cX^2 + dX + e.
\end{equation*}
To ease notation, we will 
use the dehomogenized equation to define the projective curve $C$,
remembering that there is the point at infinity $[0, 1, 0]$.

The following proposition allows us to identify elliptic curves
with smooth curves given by a Weierstrass equation.
\begin{proposition}
	\label{prop:curve-correspondence}
	Let $(E, O)$ be an elliptic curve defined over $K$.
	\begin{enumerate}[itemsep=0em, label=(\alph*)]
		\item There exist functions $x, y \in K(E)$ such that the map
			\begin{align*}
				\phi: E &\to \proj^2\\
				P &\mapsto [x(P), y(P), 1]
			\end{align*}
			gives an isomorphism of $E$  onto a curve given by the Weierstrass equation
			\begin{equation*}
				C: Y^2 + aXY + bY = X^3 + cX^2 + dX + e
			\end{equation*}
			with coefficients $a, b, c, d, e \in K$ and such that $\phi(O) =
			[0,1, 0]$.
		\item Any two equations for $E$ as in (a) are related by a linear change
			of variables of the form
			\begin{align*}
				X &= u^2X' + r\\
				Y &= u^3Y' + su^2X' + t
			\end{align*}
			with $u, r, s, t \in K, u \neq 0$.
		\item Conversely any smooth curve $C$ given by a Weierstrass equation as in (a)
			is an elliptic curve with origin $O = [0, 1, 0]$.
	\end{enumerate}
\end{proposition}

Now let $E$ be an elliptic curve defined by the Weierstrass equation
\begin{equation}
	\label{weierstrass-eq}
	E: Y^2 + aXY + bY = X^3 + cX^2 + dX + e
\end{equation}
for some $a, b, c, d, e \in K$ with origin $O = [0, 1, 0]$.

When $\chr(K) \not\in \{2, 3\}$ (recall we assumed this is true throughout this
paper), we can simplify (\ref{weierstrass-eq}) using changes of variables,
if we set $Y = Y' - \frac{1}{2}(aX'  + b)$ we obtain an equation of the form
\begin{equation*}
	Y'^2 = X^3 + c'X^2 + d'X + e'
\end{equation*}
with $c', d', e' \in K$. We can also get rid of the term $X^2$ with the
substitution $X = X' - \frac{1}{3}c'$, we obtain an equation of the form
\begin{equation*}
	Y'^2 = X'^3 + AX' + B
\end{equation*}
with $A, B \in K$. A quick calculation yields $c' = c + \frac{1}{4}a^2$,
hence up to using the linear change of variables
\begin{align*}
	X &= X' - \frac{1}{3}\left(c  + \frac{1}{4}a^2\right),\\
	Y &= Y' - \frac{1}{2}(aX'  + b),
\end{align*}
we can always suppose an elliptic curve $E$ is given by the equation
\begin{equation*}
	E: Y^2 = X^3 + AX + B.
\end{equation*}

From \ref{prop:curve-correspondence}, we know that a curve given by the an equation
of the above form is an elliptic curve whenever it is smooth.
The following proposition answers the question of when that is the case.
\begin{proposition}
	\label{prop:singular-determinant}
	Let $C$ be a projective plane curve defined by
	\begin{equation*}
		C: F(X, Y) = X^3 + AX + B - Y^2 = 0.
	\end{equation*}
	Let $\Delta = 4A^3 + 27B^2$ be the discriminant of $F(X, 0)$, then 
	$C$ is smooth (and hence an elliptic curve)
	if and only if $\Delta \neq 0$.
\end{proposition}
\begin{proof}
	First, let us verify that $O = [0, 1, 0]$ is not singular.
	If we look at $C$ in the chart $U_Y = \{Y \neq 0\}$, we get
	that $C$ is given by the equation
	\begin{equation*}
		G(X, Z) = X^3 + AXZ^2 + BZ^3 - Z = 0.
	\end{equation*}
	We have that
	\begin{equation*}
		\nabla G(0, 0) =
		\begin{bmatrix}
			0\\
			1
		\end{bmatrix} \neq 0,
	\end{equation*}
	and so $O$ is a smooth point of $C$.
	

	Suppose there is a point $P = (x, y) \in C$ that is singular,
	then we have
	\begin{equation*}
		\nabla F(P) =
		\begin{bmatrix}
			3x^2 + A\\
			-2y\\
		\end{bmatrix} = 0
	\end{equation*}
	Hence we have that $\frac{\partial}{\partial X}F(x, 0) 
	= 3x^2 + A = 0$.
	In particular, since $P \in C$, also 
	$F(x, 0) = 0$, and hence
	$x$ is a double root of $F(X, 0)$ so we deduce that the discriminant
	$\Delta = 4A^3 + 27B^2$ is zero.

	Suppose instead that $\Delta = 0$, then $F(X, 0)$ admits a double root
	$x \in K$ (recall $K$ is algebraically closed).
	Then $P = (x, 0) \in C$ and
	\begin{equation*}
		\nabla F(P) =
		\begin{bmatrix}
			3x^2 + A\\
			0\\
		\end{bmatrix} = 0,
	\end{equation*}
	since $3x^2 + A = \frac{\partial}{\partial X}F(x, 0) = 0$.
	It follows that $C$ is singular at $P$.
\end{proof}

\subsection{Group Law}

Let $E$ be an elliptic curve. By BÃ©zout's theorem,
for any line $L \subset \proj^2$, $L$ intersects
$E$ in exactly 3 points (taken with multiplicity). This allows us
to define a composition law $\oplus$ on $E$ as
follows.

\begin{definition}
	\label{def:group-law}
	Let $P, Q \in E$ and $L$ the line connecting $P$ and $Q$ (or the tangent line
	to $E$ at $P$ if $P = Q$). Let $R$ be the third point of intersection of $L$
	with $E$. Let $L'$ be the line connecting $R$ and $O$. We define $P \oplus Q$
	be the third point of intersection of $L'$ with $E$.
\end{definition}

\begin{notation}
	For $m \in \N\setminus\{0\}$ and $P \in E$ we define
	\begin{equation*}
		[m]P = \underbrace{P \oplus \dots \oplus P}_{m\textrm{ times}}.
	\end{equation*}
	We extend this definition to $m \in \Z$ with $[0]P = O$ and
	$[m]P = [-m](-P)$ for $m < 0$.
\end{notation}

As seen in the course ``Algebraic curves", this composition law gives $E$
the structure of an abelian group with identity element $O$. We will give
a different proof of this fact in what follows.

\begin{lemma}
	\label{lem:sim-implies-eq}
	Let $C$ be a curve of genus 1, and let $P, Q \in C$. Then
	\begin{equation*}
		(P) \sim (Q)
		\quad\textrm{if and only if}\quad
		P = Q
	\end{equation*}
\end{lemma}

\begin{proof}
	Suppose $(P) \sim (Q)$, then there exists some $f \in K(C)$ such that
	\begin{equation*}
		\div(f) = (P) - (Q).
	\end{equation*}
	We have that $f \in \L((Q))$ and by Riemann-Roch (\ref{thm:riemann-roch}),
	it follows that
	\begin{equation*}
		\dim \L((Q)) = \deg((Q)) - g + 1 = 1.
	\end{equation*}
	Since $\L((Q))$ already contains the constant functions, $f \in \L((Q)) = K$
	and so $P = Q$.
\end{proof}
\begin{proposition}
	Let $(E, O)$ be an elliptic curve. The map
	\begin{align*}
		\kappa: E &\to \Cl^0(E)\\
		P &\mapsto \cl{(P) - (O)}
	\end{align*}
	is a bijection. Furthermore, the group law on $E$ induced by addition in
	$\Cl^0(E)$ agrees 
	with the composition law $\oplus$ defined in \ref{def:group-law},
	i.e. for all $P, Q \in E$, 
	\begin{equation*}
		\kappa(P \oplus Q) = \kappa(P) + \kappa(Q)
	\end{equation*}
	In particular, $(E, \oplus)$ is an abelian group with identity element $O$,
	which is isomorphic to $\Cl^0(E)$.
\end{proposition}

\begin{proof}
	Let $D \in \Div^0(E)$ be a divisor. Since $E$ has genus 1, 
	by the Riemann-Roch theorem (\ref{thm:riemann-roch}), we have that
	\begin{equation*}
		\dim\L(D + (O)) = 1.
	\end{equation*}
	Let $f \in K(E)$ be a generator for $\L(D + (O))$. Since
	\begin{equation*}
		\div(f) \geq -D -(O)
		\quad\textrm{ and }\quad
		\deg(\div(f)) = 0,
	\end{equation*}
	we have necessarily that 
	\begin{equation*}
		\div(f) = -D -(O) + (P)
	\end{equation*}
	for some $P \in E$.
	Hence 
	\begin{equation*}
		D \sim (P) - (O).
	\end{equation*}
	Suppose there is some other $P' \in E$, such that $D \sim (P') - (O)$.
	Then $(P) \sim (P')$, but then $P = P'$ from \ref{lem:sim-implies-eq}.
	
	This allows us to define
	\begin{equation*}
		\sigma: \Div^0(E) \to E,
	\end{equation*}
	which sends a divisor $D \in \Div^0(E)$ to the corresponding point $P \in E$
	as above.

	This map is clearly surjective, as $\sigma((P) - (O)) = P$. Furthermore, we
	have that $\sigma(D_1) = \sigma(D_2)$ if and only if $D_1 \sim D_2$.
	Indeed, if $D_1 \sim D_2$, then 
	\begin{equation*}
		(\sigma(D_1)) - (O) \sim D_1 \sim D_2 \sim (\sigma(D_2)) - (O)
	\end{equation*}	
	and hence $\sigma(D_1) = \sigma(D_2)$ by \ref{lem:sim-implies-eq}.
	Conversely, if $\sigma(D_1) = \sigma(D_2)$, then clearly
	\begin{equation*}
		D_1 \sim (\sigma(D_1)) - (O) = (\sigma(D_2)) - (O) \sim D_2.
	\end{equation*}
	We deduce that $\sigma$ induces a bijection $\cl{\sigma}: \Cl^0(E) \to E$.
	Furthermore, clearly $\overline{\sigma} = \kappa^{-1}$.

	It remains to show that $\oplus$ agrees with the group law induced
	on $E$  by $\kappa$. We have to show that for $P, Q \in E$,
	$\kappa(P \oplus Q) = \kappa(P) + \kappa(Q)$.

	Let
	\begin{equation*}
		f(X, Y, Z) = \alpha X + \beta Y + \gamma Z = 0
	\end{equation*}
	give the line $L$ in $\proj^2$ going through $P, Q$ and let $R$ be the third
	point of intersection.
	Let $g(X, Y, Z) = 0$ be the equation for the tangent line $T$ to
	$E$ at $O$. $T$ intersects $E$ at $O$ with
	multiplicity at least 2, let $S \in E$ be the third point of intersection
	(equal to $O$ if $O$ is a flex).
	Since $g$ is homogeneous of degree 1, $f/g \in K(E)$ and so we get that
	\begin{align*}
		\div(f/g) &= \sum_{P' \in E}\ord_{P'}(f)\cdot(P')
		- \ord_{P'}(Z)\cdot(P')\\
		&= \sum_{P' \in E}I(P', E\cap L)\cdot(P') - I(P', E\cap T)\cdot(P')\\
		&= (P) + (Q) + (R) - 2(O) - (S).
	\end{align*}
	Now let 
	\begin{equation*}
		f'(X, Y, Z) = \alpha' X + \beta' Y + \gamma' Z = 0
	\end{equation*}
	be the line $L'$ through $R$ and $O$. Then by the definition of $\oplus$,
	we have that the third point of intersection of $L'$ with $E$ is 
	$P \oplus Q$. As above, $f'/T \in K(E)$ and we have
	\begin{equation*}
		\div(f'/Z) = (R) + (O) + (P \oplus Q) - 2(O) - (S)
		= (R) + (P + Q) - (O) - (S).
	\end{equation*}
	It follows that
	\begin{equation*}
		\div(f'/f) = \div(f'/T) - \div(f/T) = (P \oplus Q) - (P) - (Q) + (O)
	\end{equation*}
	And hence
	\begin{align*}
		\kappa(P \oplus Q) - \kappa(P) - \kappa(Q) &= 
		\cl{(P \oplus Q) - (O)} - \cl{(P) - (O)} - \cl{(Q) - (O)}\\
		&= \cl{(P \oplus Q) - (P) - (Q) + (O)} = 0.
	\end{align*}
	Since, $\kappa^{-1}(0) = O$, we get that $(E, \oplus)$ is an abelian
	group with identity element $O$ and $\kappa$ is a group isomorphism.
\end{proof}
\begin{notation}
	In the rest of this paper, we will write $+$ instead of $\oplus$ for 
	the composition law on $E$.
\end{notation}

As a corollary to the above proposition,
we get a useful criteria for when a divisor $D$ is principal.
\begin{corollary}
	Let $(E, O)$ be an elliptic curve and $D = \sum n_P \cdot (P) \in \Div(E)$.
	Then $D$ is principal if and only if $\sum n_P = 0$ and $\sum [n_P]P = O$
\end{corollary}

\begin{proof}
	Suppose $D$ is principal, so $D\sim 0$. 
	Principal divisors have degree $0$,
	hence $\sum n_P = 0$. It follows that
	\begin{align*}
		\kappa\left(\sum [n_P]P\right) &= \sum n_P\kappa(P) = \sum n_P
		\cdot\cl{(P) - (O)}\\
		&= \cl{\sum n_P\cdot(P)} = 0
	\end{align*}
	And hence $\sum [n_P]P = 0$ by injectivity of $\kappa$.

	Now suppose $\sum n_P = 0$ and $\sum [n_P] P = O$,
	then by the above calculation,
	\begin{equation*}
		\cl{D} = \cl{\sum n_P\cdot(P)} = \kappa\left(\sum [n_P] P\right) = 0
	\end{equation*}
	and so $D \sim 0$.
\end{proof}


Now, let $E$ be an elliptic curve given by the reduced Weierstrass equation
\begin{equation*}
	E: F(x, y) = y^2 - x^3 - ax - b = 0
\end{equation*}
with origin $O = [0, 1,0]$,
we will calculate explicit formulas for the group law in what follows.

Let $P = (x_P, y_P) \in E$, then we
\begin{equation*}
	-P = (x_P, -y_P).
\end{equation*}
Indeed, the line connecting $P$ and $(x_P, -y_P)$, is the line
$X = x_PZ$, which has as third intersection point $O$.
the tangent to $E$ at $O$ is given by $Z = 0$,
which intersects $E$ with multiplicity 3,
hence we obtain that $P+(x_P, -y_P) = O$.

Now let $Q = (x_Q, y_Q) \in E$ different from $-P$. Then $P + Q \neq O$.
Suppose $P \neq Q$, then $x_P \neq x_Q$. 
We have that the line passing through $P$ and $Q$ is given by
\begin{equation*}
	L: y = \frac{y_Q - y_P}{x_Q - x_P}(x - x_P) + y_P
\end{equation*}
Setting 
\begin{equation*}
	\lambda = \frac{y_Q - y_P}{x_Q - x_P}
	\quad\textrm{ and }\quad
	\nu = \frac{x_Qy_P - x_Py_Q}{x_Q - x_P}
\end{equation*}
we can rewrite $L: y = \lambda x - \nu$.

If $P = Q$, then $L$ is the tangent to $E$ at $P$, which is given by
\begin{equation*}
	L: (3x_P^2 + a)(x - x_P) - 2y_P(y - y_P) = 0
\end{equation*}
If $y_P = 0$, $L$ is the line $x = x_P$ and so the third point of intersection
is $O$, whence $P + Q = O$, which contradicts our assumption, and so 
$y_P \neq 0$.
To obtain again an equation of the form $L = \lambda x - \nu$, we have to set
\begin{equation*}
	\lambda = \frac{3x_P^2 + a}{2y_P}
	\quad\textrm{ and }\quad
	\nu = \frac{-3x_P^3 - ax_P + 2y_P^2}{2y_P} = \frac{-x_P^3 + ax_P + 2b}{2y_P}.
\end{equation*}

So let $\lambda$ and $\nu$ be as above corresponding to the case.
Let $R$ be the third point of intersection of $L$ with $E$.
We have that the equation $F(x, \lambda x + \nu) = 0$ with respect to $x$
admits exactly the zeroes $x_P, x_Q, x_R$ and hence
\begin{equation*}
	F(x, \lambda x + \nu) = c(x - x_P)(x - x_Q)(x - x_R)
\end{equation*}
Since the coefficient of $x^3$ in $F(x, \lambda x + \nu)$ is $-1$, we obtain
$c = -1$. By equating the coefficient of $x^2$, we obtain
$\lambda^2 = x_P + x_Q + x_R$ and hence
\begin{align*}
	x_R &= \lambda^2 - x_P - x_Q\\
	y_R &= \lambda x_R + \nu
\end{align*}
The line connecting $O$ and $R$ is the line $x = x_R$, which intersects $E$
in the third point $(x_R, -y_R)$.
Hence we obtain $P + Q = (x_R, -y_R)$.

This can be summarized in the following proposition:
\begin{proposition}
	Let $E$ be an elliptic curve given by the Weierstrass equation
	\begin{equation*}
		E: y^2 = x^3 + ax + b.
	\end{equation*}
	Let $P = (x_P, y_P), Q = (x_Q, y_Q) \in E$ be two points with $P \neq \pm Q$.
	Then 
	\begin{enumerate}
		\item The addition formula:
			\begin{align*}
				x_{P + Q} &= \left( \frac{y_Q - y_P}{x_Q - x_P} \right)^2
				- x_P - x_Q\\
				y_{P + Q} &= -\frac{y_Q - y_P}{x_Q - x_P}x_{P+Q} + \frac{x_Qy_P -
				x_Py_Q}{x_Q - x_P}
			\end{align*}
		\item The duplication formula. Write $P = (x, y)$, then
			\begin{align*}
				x_{[2]P} &= \left( \frac{3x^2 + a}{2y} \right)^2
				- 2x\\
				&= \frac{x^4 - 2ax^2 - 8bx + a^2}{4(x^3 + ax + b)}\\
				y_{[2]P} &= - \frac{3x^2 + a}{2y}x_{[2]P}
				+ \frac{-x^3 + ax + 2b}{2y}
			\end{align*}
	\end{enumerate}
\end{proposition}

\subsection{Isogenies}

\begin{definition}
	Let $E_1$ and $E_2$ be elliptic curves. An \emph{isogeny} between
	$E_1$ and $E_2$ is a morphism
	\begin{equation*}
		\phi: E_1 \to E_2
	\end{equation*}
	satisfying $\phi(O) = O$. $E_1$ and $E_2$ are \emph{isogenous} if
	there exists a non-constant isogeny $\phi$ between them.
\end{definition}

\begin{definition}
	Let $E$ be an elliptic curve and $m \in \Z$, $m \neq 0$. The
	$m$-\emph{torsion subgroup} of $E$, denoted $E[m]$, is the set of
	points of order $m$ in $E$.
	\begin{equation*}
		E[m] = \{P \in E \mid [m]P = O\}.
	\end{equation*}
	The \emph{torsion subgroup} of $E$, denoted $E_\tors$, is the set of
	points of finite order in $E$.
	\begin{equation*}
		E_\tors = \bigcup_{m=1}^\infty E[m]
	\end{equation*}
\end{definition}

\subsection{The Dual Isogeny}

\subsection{The Tate Module}

\subsection{The Weil Pairing}
