\section{Basic Definitions and Facts}

\subsection{Weierstrass Equation}

Our main interest are \emph{elliptic curves}, which are curves
in $\proj^2$ of genus 1. These are characterized by the
homogeneous equation
\begin{equation}
	\label{weierstrass-eq-1}
	Y^2Z + aXYZ + bYZ^2 = X^3 + cX^2Z + dXZ^2 + eZ^3
\end{equation}
for some $a, b, c, d, e \in \F$.
Setting $U_Z = \{[X, Y, Z] \in \proj^2 \mid Z \neq 0\}$, we can
study the solutions of (\ref{weierstrass-eq-1}) on
$U_Z$ using the change of coordinates $x = X/Z$
and $y = Y/Z$. We obtain the following equation
\begin{equation}
	\label{weierstrass-eq-2}
	y^2 + axy + by = x^3 + cx^2 + dx + e
\end{equation}
We can further simplify this equation with linear
changes of variables. First notice that if $\chr(\F) \neq 2$,
the left hand side can be
written as
\begin{align*}
	y(y + ax + b) &= (y + \frac{1}{2}(ax + b) - \frac{1}{2}(ax + b))
	(y + \frac{1}{2}(ax + b) + \frac{1}{2}(ax + b))\\
	&= (y + \frac{1}{2}(ax + b))^2 - \frac{1}{4}(ax + b)^2
\end{align*}
Hence by replacing $y$ with $y + \frac{1}{2}(ax + b)$ and
collecting the terms in each monomial, we get an equation
of the form
\begin{equation}
	y^2 = x^3 + \alpha x^2 + \beta x + \gamma
\end{equation}
If $\chr(\F) \neq 3$, we can also get rid of the term in 
$x^2$ with a linear change
of variables. replacing $x$ with $x - \frac{1}{3}\alpha$ yields
\begin{align*}
	y^2 &= (x - \frac{1}{3}\alpha)^3 + \alpha(x-\frac{1}{3}\alpha)^2
	+ \beta(x - \frac{1}{3}\alpha) + \gamma\\
	&= x^3 - \alpha x^2 + \frac{1}{3}\alpha^2 x
	- \frac{1}{27}\alpha^3 + \alpha x^2 - \frac{2}{3}\alpha^2 x
	+ \frac{1}{9}\alpha^3 + \beta x - \frac{1}{3}\alpha \beta
	+ \gamma
\end{align*}
Collecting the terms in each monomial, we get an equation of the
form
\begin{equation}
	y^2 = x^3 + Ax + B
\end{equation}
with $A, B \in \F$.
Plugging back the substitutions $x = X/Z$ and $y = Y/Z$, we obtain
the homogeneous equation
\begin{equation}
	Y^2Z = X^3 + AXZ^2 + BZ^3
\end{equation}

\subsection{Singularities}

We suppose $\F$ is algebraically closed.
	
We have that an elliptic curve $V \subset \proj_2(\F)$
is the projective variety
\begin{equation}
	V = V(X^3 + AXZ^2 + BZ^3 - Y^2Z) = V(F)
\end{equation}
We are interested in the case where the curve is smooth.
By the regular preimage theorem, $V$ is smooth if all its points
are non-singular, i.e. if for all $P = [x, y, z] \in V$,
\begin{equation*}
	\nabla F(P) = 
	\begin{bmatrix}
		3x^2 + Az^2\\
		-2yz\\
		2Axz + 3Bz^2 - y^2
	\end{bmatrix}
	\neq 0
\end{equation*}
If $P = [0, 1, 0]$, then 
\begin{equation*}
	\nabla F(P) = 
	\begin{bmatrix}
		0\\
		0\\
		-1
	\end{bmatrix} \neq 0
\end{equation*}
hence the point at infinity is never singular. It follows
that when looking for singularities, we can consider just
the case where $z \neq 0$, since else we have necessarily $x = 0$
and so $P = [0, 1, 0]$. So if there are any singularities of $V$,
they are on $V \cap U_Z$. So $V$ is non-singular precisely when
$V \cap U_Z$ is non-singular. Using the isomorphism
$V \cap U_Z \to W, [X, Y, Z] \mapsto (\frac{X}{Z}, \frac{Y}{Z})$ it
suffices to study singularities on $W = V(x^3 + Ax + B - y^2)
= V(f)$

Let $\Delta = 4A^3 + 27B^2$ be the discriminant of the polynomial
$g(x) = x^3 + Ax + B$, we have the following criteria for the
existence of singularities of $V$.

\begin{proposition}
	\label{prop:singular-determinant}
	W (and equivalently V)
	is non-singular if and only if $\Delta \neq 0$.
\end{proposition}
\begin{proof}
	Suppose there is a point $P = (x_0, y_0) \in W$ that is singular,
	then we have
	\begin{equation*}
		\begin{bmatrix}
			3x_0^2 + A\\
			-2y_0\\
		\end{bmatrix} = 0
	\end{equation*}
	Hence we have that $g'(x_0) = 3x_0^2 + A = 0$ and $y_0 = 0$.
	In particular, since $P \in W$, also 
	$g(x_0) = 0$, and hence since $g(x_0) = g'(x_0) = 0$,
	$x_0$ is a double root of $g$ and so the discriminant
	$\Delta = 4A^3 + 27B^2$ of $g$ is zero.

	Suppose instead that $\Delta = 0$, then $g$ admits a double root
	$x_0 \in \F$ (since we supposed $\F$ algebraically closed)
	which is unique since $g$ is a cubic polynomial.
	Then $P = (x_0, 0) \in V$.
	Furthermore,
	\begin{equation*}
		\nabla f(P) =
		\begin{bmatrix}
			3x^2 + A\\
			0\\
		\end{bmatrix}
	\end{equation*}
	We have that $3x^2 + A = g'(x) = 0$, hence $\nabla f(P) = 0$
	and so $W$ is singular at $P$.
\end{proof}

\subsection{Group Law}

Let $E$ be an elliptic curve. For any line $L \subset \proj^2$, $L$ intersects
$E$ in exactly 3 points (taken with multiplicity). This allows us
to define a composition law $+$ on $E$ as
follows.

\begin{definition}
	\label{def:group-law}
	Let $P, Q \in E$ and $L$ the line connecting $P$ and $Q$ (or the tangent line
	to $E$ at $P$ if $P = Q$). Let $R$ be the third point of intersection of $L$
	with $E$. Let $L'$ be the line connecting $R$ and $O$. We define $P + Q$
	be the third point of intersection of $L'$ with $E$.
\end{definition}

% Proposition: properties, it makes E an abelian group with identity O

\begin{notation}
	For $m \in \N\setminus\{0\}$ and $P \in E$ we define
	\begin{equation*}
		[m]P = \underbrace{P + \dots + P}_{m\textrm{ times}}.
	\end{equation*}
	We extend this definition to $m \in \Z$ with $[0]P = O$ and
	$[m]P = [-m](-P)$ for $m < 0$.
\end{notation}

As we have seen, any elliptic curve can be written up to isomorphism
under the form
\begin{equation*}
	E: y^2 = x^3 + ax + b
\end{equation*}
Since this isomorphism is induced by linear changes of variables, it
sends lines to lines and hence this preserves the group structure on
$E$ induced by $+$. Hence in what follows, we consider simply elliptic curves of
the above form.
Let $F(x, y) = y^2 - x^3 - ax - b$, so that $E$ is given by the equation
$F(x, y) = 0$.

Let $P = (x_P, y_P) \in E$, then we
\begin{equation*}
	-P = (x_P, -y_P),
\end{equation*}
which is clear by inspection of the composition law.

Now let $Q = (x_Q, y_Q) \in E$ different from $-P$. Then $P + Q \neq O$.
Suppose $P \neq Q$, then $x_P \neq x_Q$. 
We have that the line passing through $P$ and $Q$ is given by
\begin{equation*}
	L: y = \frac{y_Q - y_P}{x_Q - x_P}(x - x_P) + y_P
\end{equation*}
Setting 
\begin{equation*}
	\lambda = \frac{y_Q - y_P}{x_Q - x_P}
	\quad\textrm{ and }\quad
	\nu = \frac{x_Qy_P - x_Py_Q}{x_Q - x_P}
\end{equation*}
we can rewrite $L: y = \lambda x - \nu$.

If $P = Q$, then $L$ is the tangent to $E$ at $P$, which is given by
\begin{equation*}
	L: (3x_P^2 + a)(x - x_P) - 2y_P(y - y_P) = 0
\end{equation*}
If $y_P = 0$, $L$ is the line $x = x_P$ and so the third point of intersection
is $O$, whence $P + Q = O$, which contradicts our assumption, and so 
$y_P \neq 0$.
To obtain again an equation of the form $L = \lambda x - \nu$, we have to set
\begin{equation*}
	\lambda = \frac{3x_P^2 + a}{2y_P}
	\quad\textrm{ and }\quad
	\nu = \frac{-3x_P^3 - ax_P + 2y_P^2}{2y_P} = \frac{-x_P^3 + ax_P + 2b}{2y_P}.
\end{equation*}

So let $\lambda$ and $\nu$ be as above corresponding to the case.
Let $R$ be the third point of intersection of $L$ with $E$.
We have that the equation $F(x, \lambda x + \nu) = 0$ with respect to $x$
admits exactly the zeroes $x_P, x_Q, x_R$ and hence
\begin{equation*}
	F(x, \lambda x + \nu) = c(x - x_P)(x - x_Q)(x - x_R)
\end{equation*}
Since the coefficient of $x^3$ in $F(x, \lambda x + \nu)$ is $-1$, we obtain
$c = -1$. By equating the coefficient of $x^2$, we obtain
$\lambda^2 = x_P + x_Q + x_R$ and hence
\begin{align*}
	x_R &= \lambda^2 - x_P - x_Q\\
	y_R &= \lambda x_R + \nu
\end{align*}
Finally, we obtain $P + Q = (x_R, -y_R)$.

This can be summarized in the following proposition:
\begin{proposition}
	Let $E$ be an elliptic curve given by the Weierstrass equation
	\begin{equation*}
		E: y^2 = x^3 + ax + b.
	\end{equation*}
	Let $P = (x_P, y_P), Q = (x_Q, y_Q) \in E$ be two points with $P \neq \pm Q$.
	Then 
	\begin{enumerate}
		\item The addition formula:
			\begin{align*}
				x_{P + Q} &= \left( \frac{y_Q - y_P}{x_Q - x_P} \right)^2
				- x_P - x_Q\\
				y_{P + Q} &= -\frac{y_Q - y_P}{x_Q - x_P}x_{P+Q} + \frac{x_Qy_P -
				x_Py_Q}{x_Q - x_P}
			\end{align*}
		\item The duplication formula. Write $P = (x, y)$, then
			\begin{align*}
				x_{[2]P} &= \left( \frac{3x^2 + a}{2y} \right)^2
				- 2x\\
				&= \frac{x^4 - 2ax^2 - 8bx + a^2}{4(x^3 + ax + b)}\\
				y_{[2]P} &= - \frac{3x^2 + a}{2y}x_{[2]P}
				+ \frac{-x^3 + ax + 2b}{2y}
			\end{align*}
	\end{enumerate}
\end{proposition}


\begin{lemma}
	\label{lem:sim-implies-eq}
	Let $C$ be a curve of genus 1, and let $P, Q \in C$. Then
	\begin{equation*}
		(P) \sim (Q)
		\quad\textrm{if and only if}\quad
		P = Q
	\end{equation*}
\end{lemma}

\begin{proof}
	Suppose $(P) \sim (Q)$, then there exists some $f \in K(C)$ such that
	\begin{equation*}
		\div(f) = (P) - (Q).
	\end{equation*}
	We have that $f \in \L((Q))$ and by Riemann-Roch (\ref{thm:riemann-roch}),
	it follows that
	\begin{equation*}
		\dim \L((Q)) = \deg((Q)) - g + 1 = 1.
	\end{equation*}
	Since $\L((Q))$ already contains the constant functions, $f \in \L((Q)) = K$
	and so $P = Q$.
\end{proof}

\begin{proposition}
	Let $E$ be an elliptic curve. Then $E$ equipped with the group law from 
	\ref{def:group-law}
	and $\Cl^0(E)$ are isomorphic. The isomorphism is given by the map
	\begin{align*}
		\kappa: E &\to \Cl^0(E)\\
		P &\mapsto [(P) - (O)]
	\end{align*}
\end{proposition}

\begin{proof}
	Let $D \in Div^0(E)$ be a divisor. Since $E$ has genus 1, 
	by the Riemann-Roch theorem (\ref{thm:riemann-roch}), we have that
	\begin{equation*}
		\dim\L(D + (O)) = 1.
	\end{equation*}
	Let $f \in K(E)$ be a generator for $\L(D + (O))$. Since
	\begin{equation*}
		\div(f) \geq -D -(O)
		\quad\textrm{ and }\quad
		\deg(\div(f)) = 0,
	\end{equation*}
	we have necessarily that 
	\begin{equation*}
		\div(f) = -D -(O) + (P)
	\end{equation*}
	for some $P \in E$.
	Hence 
	\begin{equation*}
		D \sim (P) - (O).
	\end{equation*}
	Suppose there is some other $P' \in E$, such that $D \sim (P') - (O)$.
	Then $(P) \sim (P')$, but then $P = P'$ from \ref{lem:sim-implies-eq}.
	
	This allows us to define
	\begin{equation*}
		\sigma: \Div^0(E) \to E,
	\end{equation*}
	which sends a divisor $D \in \Div^0(E)$ to the corresponding point $P \in E$
	as above.

	This map is clearly surjective, as $\sigma((P) - (O)) = P$. Furthermore, we
	have that $\sigma(D_1) = \sigma(D_2)$ if and only if $D_1 \sim D_2$.
	Indeed, if $D_1 \sim D_2$, then 
	\begin{equation*}
		(\sigma(D_1)) - (O) \sim (\sigma(D_2)) - (O)
	\end{equation*}	
	and hence $\sigma(D_1) = \sigma(D_2)$ by \ref{lem:sim-implies-eq}.
	Conversely, if $\sigma(D_1) = \sigma(D_2)$, then clearly
	\begin{equation*}
		D_1 \sim (\sigma(D_1)) - (O) = (\sigma(D_2)) - (O) \sim D_2.
	\end{equation*}
	We deduce that $\sigma$ induces a bijection $\cl{\sigma}: \Cl^0(E) \to E$.
	Furthermore, clearly $\overline{\sigma} = \kappa^{-1}$.

	It remains to show that $\kappa$ is a group homomorphism.
	Clearly, $\kappa(O) = 0$, so we have to show that for $P, Q \in E$,
	$\kappa(P + Q) = \kappa(P) + \kappa(Q)$.
\end{proof}
